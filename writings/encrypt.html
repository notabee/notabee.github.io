<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The Lock // Encryptor</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.1.1/crypto-js.min.js"></script>
    <style>
        body {
            background-color: #050505;
            color: #FF0055;
            font-family: 'Courier New', monospace;
            padding: 40px;
            max-width: 800px;
            margin: 0 auto;
        }
        h1 { border-bottom: 2px solid #FF0055; padding-bottom: 10px; }
        .group { margin-bottom: 20px; }
        label { display: block; margin-bottom: 5px; color: #fff; }
        input, textarea { 
            width: 100%; 
            background: #111; 
            border: 1px solid #333; 
            color: #ddd; 
            padding: 10px; 
            font-family: inherit;
            box-sizing: border-box;
        }
        textarea { height: 200px; resize: vertical; }
        button {
            background: #FF0055;
            color: #000;
            border: none;
            padding: 15px 30px;
            font-size: 1.2rem;
            cursor: pointer;
            font-weight: bold;
            text-transform: uppercase;
        }
        button:hover { background: #fff; }
        #output {
            margin-top: 30px;
            background: #111;
            padding: 20px;
            border: 1px dashed #555;
            word-break: break-all;
            color: #00F3FF;
            display: none;
        }
    </style>
</head>
<body>

    <h1>THE LOCK // ENCRYPTOR</h1>
    <p style="color: #888">Use this tool locally to encrypt your specialized writings. Result is a JSON object to add to vault.json.</p>

    <div class="group">
        <label>Passphrase (The Key)</label>
        <input type="password" id="key" placeholder="Enter the master key...">
    </div>

    <div class="group">
        <label>Title</label>
        <input type="text" id="title" placeholder="Title of the writing...">
    </div>

    <div class="group">
        <label>Date</label>
        <input type="text" id="date" placeholder="e.g. Oct 31, 2024">
    </div>

    <div class="group">
        <label>Content (Markdown supported)</label>
        <textarea id="content" placeholder="Write your thoughts..."></textarea>
    </div>

    <button onclick="encrypt()">Generate Encrypted Blob</button>

    <div id="output">
        <h3>Encrypted Object (Copy this to vault.json):</h3>
        <pre id="json-output"></pre>
        <button onclick="copyToClipboard()" style="font-size: 0.8rem; padding: 5px 10px; margin-top: 10px;">Copy to Clipboard</button>
    </div>

    <script>
        function encrypt() {
            const key = document.getElementById('key').value;
            const title = document.getElementById('title').value;
            const date = document.getElementById('date').value;
            const content = document.getElementById('content').value;

            if (!key || !title || !content) {
                alert("Missing required fields (Key, Title, Content)");
                return;
            }

            // We encrypt the content object as a string
            const dataToEncrypt = JSON.stringify({
                title: title,
                date: date,
                content: content
            });

            // Encrypt
            const encrypted = CryptoJS.AES.encrypt(dataToEncrypt, key).toString();

            // Create the storage object
            // We store a subtle hint or ID if needed, but here just the blob
            const storageObj = {
                id: Date.now().toString(36),
                data: encrypted
            };

            const jsonStr = JSON.stringify(storageObj, null, 4);
            
            document.getElementById('json-output').innerText = ",\n" + jsonStr;
            document.getElementById('output').style.display = 'block';
        }

        function copyToClipboard() {
            const text = document.getElementById('json-output').innerText.replace(/^,\n/, '');
            navigator.clipboard.writeText(text).then(() => {
                alert("Copied!");
            });
        }
    </script>
</body>
</html>
